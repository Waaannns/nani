{% extends "base.html" %}

{% block title %}{% if keyword %}Hasil Pencarian {{ keyword }}{% else %}Cari Anime{% endif %} - AnimeStream{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-8">
        {% if keyword %}
        <h1 class="text-3xl font-bold mb-4">
            <i class="fas fa-search mr-2"></i>
            Hasil Pencarian: "{{ keyword }}"
        </h1>
        {% else %}
        <h1 class="text-3xl font-bold mb-4">
            <i class="fas fa-search mr-2"></i>
            Cari Anime
        </h1>
        {% endif %}
    </div>

    {% if results %}
        {% if 'data' in results and results['data'] %}
        <div class="mb-4">
            <p class="text-gray-400">Ditemukan {{ results['data'][0]['jumlah'] }} hasil</p>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
            {% for anime in results['data'][0]['result'] %}
            <div class="anime-card rounded-lg overflow-hidden card-hover">
                <a href="{{ url_for('anime_detail', anime_url=anime.get('url', '')) }}" class="block">
                    <div class="aspect-[3/4] bg-gray-800 relative overflow-hidden">
                        {% if anime.get('cover') %}
                        <img src="{{ anime['cover'] }}" 
                                alt="{{ anime.get('judul', 'Anime') }}"
                                class="w-full h-full object-cover"
                                loading="lazy">
                        {% else %}
                        <div class="w-full h-full flex items-center justify-center">
                            <i class="fas fa-image text-4xl text-gray-600"></i>
                        </div>
                        {% endif %}
                        
                        <div class="absolute inset-0 bg-black/50 opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                            <i class="fas fa-play-circle text-4xl text-white"></i>
                        </div>
                    </div>
                    
                    <div class="p-4">
                        <h3 class="font-semibold text-sm line-clamp-2 mb-2">
                            {{ anime.get('judul', 'Untitled') }}
                        </h3>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
        
        {% elif 'error' in results %}
        <div class="text-center py-16">
            <i class="fas fa-exclamation-triangle text-6xl text-red-500 mb-4"></i>
            <h3 class="text-2xl font-bold mb-2">Terjadi Kesalahan</h3>
            <p class="text-gray-400 mb-4">{{ results['error'] }}</p>
            <button onclick="location.reload()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-semibold transition-colors">
                <i class="fas fa-refresh mr-2"></i>
                Coba Lagi
            </button>
        </div>
        
        {% else %}
        <div class="text-center py-16">
            <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
            <h3 class="text-2xl font-bold mb-2">Tidak ditemukan hasil</h3>
            <p class="text-gray-400 mb-4">Coba gunakan kata kunci yang berbeda</p>
        </div>
        {% endif %}
        
    {% elif keyword %}
    <div class="text-center py-16">
        <div class="loading w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"></div>
        <p class="text-gray-400">Mencari anime...</p>
    </div>
    
    {% else %}
    <div class="text-center py-16">
        <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
        <h3 class="text-2xl font-bold mb-2">Cari Anime Favorit Anda</h3>
        <p class="text-gray-400 mb-8">Gunakan form pencarian di atas untuk menemukan anime yang ingin ditonton</p>
        
        <div class="max-w-2xl mx-auto">
            <h4 class="text-lg font-semibold mb-4">Pencarian Populer:</h4>
            <div class="flex flex-wrap gap-2 justify-center">
                <a href="{{ url_for('search', name='Naruto') }}" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-full text-sm transition-colors">
                    Naruto
                </a>
                <a href="{{ url_for('search', name='Attack on Titan') }}" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-full text-sm transition-colors">
                    Attack on Titan
                </a>
                <a href="{{ url_for('search', name='One Piece') }}" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-full text-sm transition-colors">
                    One Piece
                </a>
                <a href="{{ url_for('search', name='Demon Slayer') }}" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-full text-sm transition-colors">
                    Demon Slayer
                </a>
                <a href="{{ url_for('search', name='My Hero Academia') }}" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-full text-sm transition-colors">
                    My Hero Academia
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<style>
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %}
